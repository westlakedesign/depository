(function(){"use strict";window.depository=function(e,n){var t,o,r,a,d,i;t={};o={};r={};a={};d=[];i=false;o.url=document.URL;o.method="POST";o.fieldName="image";o.multi=true;o.accept=["image/jpeg","image/png","image/gif"];o.dataType="Text";o.csrfParam=undefined;o.csrfToken=undefined;o.onBodyEnter=function(){return undefined};o.onBodyLeave=function(){return undefined};o.onEnter=function(){return undefined};o.onLeave=function(){return undefined};o.onStart=function(){return undefined};o.onProgress=function(){return undefined};o.onSuccess=function(){return undefined};o.onAbort=function(){return undefined};o.onError=function(){return undefined};o.afterUpload=function(){return undefined};if(document.getElementsByName("csrf-param").length&&document.getElementsByName("csrf-token").length){o.csrfParam=document.getElementsByName("csrf-param")[0].content;o.csrfToken=document.getElementsByName("csrf-token")[0].content}r.init=function(e,n){var o;if(!a.isHTML5()){return}t.body=document.getElementsByTagName("body")[0];t.dropzone=r.processElement(e);o=r.getDataOptions(t.dropzone);r.processOptions(o);r.processOptions(n);r.addHandlers()};r.processElement=function(e){var n;if(e.length===undefined){n=e}else{n=e[0]}return n};r.getDataOptions=function(e){var n;n={};[].forEach.call(e.attributes,function(e){var t,o;if(/^data-dnd-/.test(e.name)){t=a.camelCase(e.name.replace(/^data-dnd-/,""));o=e.value;if(/^on/.test(t)){if(typeof window[o]==="function"){n[t]=window[o]}}else{n[t]=o}}});return n};r.processOptions=function(e){var n;if(e===undefined){return}n=Object.keys(o);Object.keys(e).forEach(function(t){if(n.indexOf(t)!==-1){o[t]=e[t]}})};r.addHandlers=function(){var e;t.dropzone.addEventListener("dragenter",function(e){a.stop(e);o.onEnter(e)});t.dropzone.addEventListener("dragleave",function(e){a.stop(e);o.onLeave(e)});t.dropzone.addEventListener("drop",function(n){a.stop(n);o.onLeave(n);o.onBodyLeave(n);clearTimeout(e);e=undefined;r.handleFileDrop(n)});t.dropzone.addEventListener("dragover",function(e){e.dataTransfer.dropEffect="copy"});document.addEventListener("dragover",function(n){a.stop(n);if(e===undefined){o.onBodyEnter(n)}clearTimeout(e);e=setTimeout(function(){o.onBodyLeave(n);e=undefined},100)});document.addEventListener("drop",a.stop)};r.handleFileInput=function(e){r.processFiles(e.dataTransfer.files);r.startUpload()};r.handleFileDrop=function(e){r.processFiles(e.dataTransfer.files);r.startUpload()};r.processFiles=function(e){var n;if(o.multi===false){r.addToQueue(e[0])}else{for(n=0;n<e.length;n+=1){r.addToQueue(e[n])}}};r.addToQueue=function(e){if(o.accept.indexOf(e.type)===-1){return}d.push(e)};r.startUpload=function(){if(i||d.length===0){return}i=true;o.onStart();r.uploadAFile()};r.uploadAFile=function(){var e,n,t;e=d.shift();n=new FormData;n.append(o.fieldName,e);if(typeof o.csrfParam==="string"&&typeof o.csrfToken==="string"){n.append(o.csrfParam,o.csrfToken)}t=new XMLHttpRequest;t.upload.addEventListener("progress",o.onProgress,false);t.addEventListener("abort",o.onAbort,false);t.addEventListener("error",function(){var e;e=t.responseText;if(o.dataType==="JSON"){try{e=JSON.parse(e)}catch(n){e=""}}o.onError(e,0)});t.addEventListener("load",function(){var e,n;n=t.status;e=t.responseText;if(o.dataType==="JSON"){try{e=JSON.parse(e)}catch(a){e=""}}if(/2\d{2}/.test(n.toString())){o.onSuccess(e,n)}else{o.onError(e,n)}r.next()},false);t.open(o.method,o.url);t.setRequestHeader("X-Requested-With","XMLHttpRequest");if(o.dataType==="JSON"){t.setRequestHeader("Accept","application/json")}t.send(n)};r.next=function(){if(d.length===0){i=false;o.afterUpload();return}r.uploadAFile()};a.isHTML5=function(){return(typeof FormData==="function"||typeof FormData==="object")&&(typeof XMLHttpRequest==="function"||typeof XMLHttpRequest==="object")};a.stop=function(e){e.preventDefault();e.stopPropagation()};a.camelCase=function(e){e=e.replace(/-([\w\W])/g,function(e,n){return n.toUpperCase()});return e};r.init(e,n);return o}})();